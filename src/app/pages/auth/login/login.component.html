<!-- src/app/pages/auth/login/login.component.html -->
<div class="login-container">
    <nb-card class="login-card">
        <nb-card-header class="text-center">
            <nb-icon icon="calculator-outline" class="logo-icon"></nb-icon>
            <h2>Welcome to ComptAssist</h2>
            <p>Sign in to your account</p>
        </nb-card-header>

        <nb-card-body>
            <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
                <div class="form-group">
                    <nb-form-field>
                        <input
                                nbInput
                                fullWidth
                                type="email"
                                formControlName="email"
                                placeholder="Email address"
                                [status]="getFieldStatus('email')"
                                autocomplete="email">
                        <nb-icon
                                nbPrefix
                                icon="email-outline"
                                pack="eva">
                        </nb-icon>
                    </nb-form-field>

                    @if (loginForm.get('email')?.invalid && (loginForm.get('email')?.dirty || loginForm.get('email')?.touched)) {
                        <div class="error-message">
                            @if (loginForm.get('email')?.errors?.['required']) {
                                <span>Email is required</span>
                            }
                            @if (loginForm.get('email')?.errors?.['email']) {
                                <span>Please enter a valid email address</span>
                            }
                        </div>
                    }
                </div>

                <div class="form-group">
                    <nb-form-field>
                        <input
                                nbInput
                                fullWidth
                                [type]="showPassword ? 'text' : 'password'"
                                formControlName="password"
                                placeholder="Password"
                                [status]="getFieldStatus('password')"
                                autocomplete="current-password">
                        <nb-icon
                                nbPrefix
                                icon="lock-outline"
                                pack="eva">
                        </nb-icon>
                        <button
                                nbButton
                                ghost
                                type="button"
                                (click)="togglePasswordVisibility()"
                                class="password-toggle">
                            <nb-icon
                                    [icon]="showPassword ? 'eye-off-outline' : 'eye-outline'"
                                    pack="eva">
                            </nb-icon>
                        </button>
                    </nb-form-field>

                    @if (loginForm.get('password')?.invalid && (loginForm.get('password')?.dirty || loginForm.get('password')?.touched)) {
                        <div class="error-message">
                            @if (loginForm.get('password')?.errors?.['required']) {
                                <span>Password is required</span>
                            }
                            @if (loginForm.get('password')?.errors?.['minlength']) {
                                <span>Password must be at least 6 characters long</span>
                            }
                        </div>
                    }
                </div>

                <div class="form-options">
                    <nb-checkbox formControlName="rememberMe">Remember me</nb-checkbox>
                    <a routerLink="/auth/forgot-password" class="forgot-password">Forgot password?</a>
                </div>

                <button
                        nbButton
                        fullWidth
                        status="primary"
                        size="large"
                        type="submit"
                        [disabled]="loginForm.invalid || isLoading"
                        class="login-button">
                    @if (isLoading) {
                        <nb-icon icon="loader-outline" class="spinner" pack="eva"></nb-icon>
                    } @else {
                        <span>Sign In</span>
                    }
                </button>

                @if (loginError) {
                    <nb-alert status="danger" class="error-alert">
                        {{ loginError }}
                    </nb-alert>
                }

                <div class="register-link">
                    Don't have an account? <a routerLink="/auth/register">Create one</a>
                </div>
            </form>
        </nb-card-body>
    </nb-card>
</div>